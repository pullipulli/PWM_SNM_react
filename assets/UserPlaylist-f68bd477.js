import{f as v,h as F,r as a,q as S,i as w,j as t,S as d,B as P}from"./index-947d2898.js";import{a as n,e as l}from"./axios-99f4dd66.js";import{u as R,F as E,R as o}from"./RHFTextField-481993f0.js";import{R as O}from"./RHFSwitch-58290f38.js";import{R as q}from"./RHFAutocomplete-974d5ff5.js";import{P as A}from"./PlaylistPreview-7422a2eb.js";import"./IconButton-3a3ad926.js";import"./createSvgIcon-0a8def60.js";function N(){var c;const{getUser:i,isLoggedIn:u}=v(),g=F(),[x,f]=a.useState([]),[y,h]=a.useState([]),p=R(),{user:m}=S(),r=m===((c=i())==null?void 0:c.username),j=async e=>{var s;e.owner=(s=i())==null?void 0:s.username,e.privacy=e.privacy===!0?"public":"private",await n.post(l.playlists,e),window.location.reload()};return a.useEffect(()=>{u()||g(w.login.path)},[u]),a.useEffect(()=>{n.get(`${l.playlists}/${m}`).then(e=>{r||(e.data=e.data.filter(s=>s.privacy==="public")),f(e.data)})},[i]),a.useEffect(()=>{n.get(l.songs).then(e=>{h(e.data)})},[]),t.jsxs(t.Fragment,{children:[t.jsx(d,{direction:"row",spacing:2,children:x.map(e=>t.jsx(A,{playlist:e,isOwner:r},e._id.name))}),r&&t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"Se vuoi aggiungere un'altra playlist:"}),t.jsx(E,{...p,children:t.jsx("form",{onSubmit:p.handleSubmit(j),children:t.jsxs(d,{spacing:2,children:[t.jsx(o,{type:"text",name:"name",label:"Nome della playlist",required:!0}),t.jsx(q,{name:"songs",label:"Canzoni da inserire in playlist",options:y,getOptionLabel:e=>{const s=e.song.artists.map(b=>b.name);return`${e.song.name} (${s})`},isOptionEqualToValue:(e,s)=>e._id===s._id,multiple:!0,required:!0}),t.jsx(o,{type:"text",name:"description",label:"Descrizione della playlist",multiline:!0}),t.jsx(O,{labelOff:"private",labelOn:"public",name:"privacy",label:"prova"}),t.jsx(o,{type:"text",name:"tags",label:"Tags",multiline:!0}),t.jsx(P,{type:"submit",children:"Aggiungi playlist"})]})})})]})]})}export{N as default};
